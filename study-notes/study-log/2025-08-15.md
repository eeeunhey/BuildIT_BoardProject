# 📆 2025-08-15 — 마이페이지 회원유형 분기 구현

## 📌 주제
로그인한 사용자의 회원 유형(`CLIENT` / `PARTNER`)에 따라 마이페이지 화면을 각각 다른 JSP로 분기하는 기능 구현

---

## 📖 배운 점
1. **JSP에서 분기 vs 서버에서 분기**
   - JSP에서 `<c:choose>`로 링크를 다르게 출력하는 방법
   - 서버 컨트롤러에서 한 엔드포인트(`/my/mypage.do`)로 받아서 forward하는 방법 (추천: 보안/유지보수 용이)
2. **세션의 `userVO` 활용**
   - 로그인 시 `memberType`을 세션에 저장하면 이후 페이지 접근 시 권한·화면 제어 가능
3. **보안 처리**
   - `WEB-INF` 내부 JSP로 직접 접근 방지
   - 알 수 없는 유형이면 로그인 페이지로 리다이렉트

---

## 🔄 구현 흐름
1. **상단바(topMenu.jsp)**  
   - "마이페이지" 메뉴를 `/my/mypage.do`로 고정
2. **컨트롤러(MyPageController)**  
   - 세션의 `userVO` 확인 → `memberType` 값에 따라 `client.jsp` 또는 `partner.jsp`로 forward
3. **JSP 뷰(client.jsp / partner.jsp)**  
   - 각 회원 유형에 맞는 정보와 UI 표시
4. **로그아웃 컨트롤러(LogoutController)**  
   - 세션 무효화 후 메인 페이지로 이동

---

## 💻 핵심 코드 요약

**`topMenu.jsp`**
```jsp
<li role="menuitem"><a href="${ctx}/my/mypage.do">마이페이지</a></li>

MyPageController.java

@WebServlet("/my/mypage.do")
public class MyPageController extends HttpServlet {
  protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
    HttpSession session = req.getSession(false);
    UserVO user = (session != null) ? (UserVO) session.getAttribute("userVO") : null;

    if (user == null) {
      resp.sendRedirect(req.getContextPath() + "/login/login.do");
      return;
    }

    String type = user.getMemberType().toUpperCase();
    String view = "/WEB-INF/views/my/" + (type.equals("CLIENT") ? "client.jsp" : "partner.jsp");

    req.getRequestDispatcher(view).forward(req, resp);
  }
}
