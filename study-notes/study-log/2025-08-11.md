# 2025-08-11 학습 기록  
## 📌 메인 페이지 최신 게시글 4개 출력 기능 (hotBoardList) & 이미지 스트리밍 이해

---

## 1. 구현 목표
- 메인 페이지에서 **최신 게시글 4개**를 카드 형태로 표시  
- 각 카드에는 **제목, 위치, 급여, 마감일, 이미지**가 포함  
- DB에 저장된 이미지(BLOB)를 **/board/image.do** 로 요청하면
  브라우저에서 바로 볼 수 있도록 만들어준다 

---

## 2. 데이터 흐름

**전체 흐름**  
```
브라우저 요청(/index.do)
     ↓
IndexController
     ↓
BoardService
     ↓
BoardDAO
     ↓
DB (tbl_board, 이미지 컬럼)
     ↓
JSP 렌더링 (hotBoardList)
```

**이미지 요청 흐름**  
```
브라우저 img 태그 src="/board/image.do?postId=..."
     ↓
BoardImageController
     ↓
BoardService
     ↓
BoardDAO
     ↓
DB (이미지 BLOB)
     ↓
HTTP 응답 (image/jpeg)
```

---

## 3. 각 계층별 역할

### 1) IndexController
```java
req.setAttribute("hotBoardList", boardService.findLatest(4));
```
- `/index.do` 요청을 받음  
- BoardService 호출해 최신 게시글 목록 가져옴  
- JSP로 데이터 전달 (setAttribute)  

### 2) BoardService
```java
public List<BoardVO> findLatest(int limit) {
    return boardDAO.findLatest(limit);
}
```
- 비즈니스 로직 처리 계층  
- DAO에서 가져온 데이터를 가공하거나 후처리할 수 있음  
- 현재는 단순히 DAO 결과를 반환  

### 3) BoardDAO
```java
List<BoardVO> findLatest(int limit);
```
- 실제 DB에서 최신 게시글 N개 조회  
- limit 값으로 몇 개를 가져올지 결정  
- MyBatis나 JDBC로 SQL 실행  

### 4) BoardImageController
```java
byte[] imageData = boardService.getImageByPostId(postId);
resp.setContentType("image/jpeg");
resp.getOutputStream().write(imageData);
```
- `/board/image.do` 요청 시 postId로 DB에서 이미지 읽음  
- HTTP 응답을 이미지 데이터로 전송 → 브라우저가 그림처럼 표시  

---

## 4. 오늘 느낀 점 & 이해 안 된 부분
- `/board/image.do?postId=...`가 동작하는 원리는 **img 태그가 자동으로 서버에 GET 요청을 보내고** 서버가 해당 postId 이미지 데이터를 응답하는 방식임을 알았음  

- Service 계층의 역할은 아직 조금 애매하게 느껴짐. 단순 데이터 전달 외에 **왜 필요한지** 감이 덜 옴 → 추후 비즈니스 로직이 많아질 때 필요성을 더 체감할 듯  
- Controller → Service → DAO → DB → JSP 구조가 이제는 조금 보이지만, 이미지의 경우도 동일 흐름이라는 점이 새로웠음  

---

## 5. 개선 아이디어
- Service에서 이미지의 MIME 타입까지 관리하도록 확장 가능  
- 이미지가 없을 경우 기본 이미지를 DAO 단계에서 처리해도 좋을 듯  
