# 📆 2025-08-16 --- 마이페이지 회원유형 분기 & 파트너 프로필(교육 이력) 구현

## 📌 주제

로그인한 사용자의 회원 유형(`CLIENT` / `PARTNER`)에 따라 마이페이지
화면을 각각 다른 JSP로 분기하고, **파트너 프로필 편집 페이지에서 교육
이력(부트캠프/자격증/온라인 강의 등)을 여러 개 추가/삭제**하는 UI를
구현.

------------------------------------------------------------------------

## 📖 배운 점

-   JSP 대신 **서버 컨트롤러 분기**가 안전하고 유지보수에 유리함\
-   세션 `userVO.memberType`으로 권한/화면 분기 가능\
-   `<c:choose>`는 **직계 자식으로 `<c:when>` / `<c:otherwise>`만 허용**
    → HTML 주석 금지, JSP 주석 사용\
-   폼 배열 네이밍(`name="field[]"`) + `getParameterValues()`로 수집하면
    편리\
-   CSS는 라이트 모드 전용으로 분리

------------------------------------------------------------------------

## 🔄 구현 흐름

1.  상단바 → "마이페이지" 링크 `/my/mypage.do` 고정\
2.  컨트롤러에서 회원 유형에 따라 `client.jsp` / `partnerpage.jsp`
    forward\
3.  파트너 페이지 → 교육 이력 동적 행 추가/삭제 구현\
4.  스타일은 `profile.css`에서 라이트 전용 관리

------------------------------------------------------------------------

## 💻 핵심 코드

### 1) `MyPageController.java`

``` java
@WebServlet("/my/mypage.do")
public class MyPageController extends HttpServlet {
  @Override
  protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
    HttpSession session = req.getSession(false);
    UserVO user = (session != null) ? (UserVO) session.getAttribute("userVO") : null;

    if (user == null) {
      resp.sendRedirect(req.getContextPath() + "/login/login.do");
      return;
    }

    String type = (user.getMemberType() == null) ? "" : user.getMemberType().toUpperCase();
    String view;
    if ("CLIENT".equals(type)) {
      view = "/WEB-INF/views/my/client.jsp";
    } else if ("PARTNER".equals(type)) {
      view = "/WEB-INF/views/my/partnerpage.jsp";
    } else {
      resp.sendRedirect(req.getContextPath() + "/login/login.do");
      return;
    }
    req.getRequestDispatcher(view).forward(req, resp);
  }
}
```

### 2) 파트너 페이지 교육 이력 (JSP)

``` jsp
<c:choose>
  <c:when test="${not empty profile.educationList}">
    <c:forEach var="e" items="${profile.educationList}">
      <div class="item">
        <input type="text" name="educationTitle[]" value="${e.title}">
        <input type="text" name="educationProvider[]" value="${e.provider}">
        <input type="month" name="educationStart[]" value="${e.start}">
        <input type="month" name="educationEnd[]" value="${e.end}">
        <select name="educationType[]">
          <option ${e.type=='부트캠프' ? 'selected':''}>부트캠프</option>
          <option ${e.type=='자격증 과정' ? 'selected':''}>자격증 과정</option>
          <option ${e.type=='온라인 강의' ? 'selected':''}>온라인 강의</option>
          <option ${e.type=='세미나/워크샵' ? 'selected':''}>세미나/워크샵</option>
          <option ${e.type=='기타' ? 'selected':''}>기타</option>
        </select>
        <input type="text" name="educationNote[]" value="${e.note}">
        <button type="button" class="remove-edu">삭제</button>
      </div>
    </c:forEach>
  </c:when>
  <c:otherwise>
    <div class="item">
      <input type="text" name="educationTitle[]">
      <input type="text" name="educationProvider[]">
      <input type="month" name="educationStart[]">
      <input type="month" name="educationEnd[]">
      <select name="educationType[]">
        <option selected>부트캠프</option>
        <option>자격증 과정</option>
        <option>온라인 강의</option>
        <option>세미나/워크샵</option>
        <option>기타</option>
      </select>
      <input type="text" name="educationNote[]">
      <button type="button" class="remove-edu">삭제</button>
    </div>
  </c:otherwise>
</c:choose>
```

### 3) 동적 추가/삭제 JS

``` html
<script>
  const list = document.getElementById('eduList');
  document.getElementById('addEdu').onclick = () =>
    list.insertAdjacentHTML('beforeend', rowHTML);

  list.addEventListener('click', e => {
    if (e.target.classList.contains('remove-edu')) e.target.closest('.item').remove();
  });
</script>
```

------------------------------------------------------------------------

## 🧪 체크리스트

-   [ ] 회원 유형에 맞는 JSP로 정상 분기되는가?\
-   [ ] 파트너 교육 이력이 동적으로 추가/삭제되는가?\
-   [ ] 제출 시 배열 파라미터가 서버에 정상 전달되는가?\
-   [ ] `<c:choose>` 내부에 JSP 주석만 있는가?
